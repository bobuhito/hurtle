<!DOCTYPE html>
<html>
<body>
<canvas id="myCanvas"></canvas><br>
<script>

let c = document.getElementById("myCanvas");
let ctx = c.getContext("2d");

const xmid = 800;
const ymid = 500;
const Wchart = xmid*1.2;
const Hchart = ymid*1.2;
ctx.canvas.width = Wchart;
ctx.canvas.height = Hchart;

ctx.font = "bold 20px serif";
ctx.fillText("<--> to Tilt,   Mouse to Insert,   Backspace to roughly Undo", xmid*0.2, ymid*1.1);


const s=Math.sqrt(3);
const TINY = 1.0e-6;

//const pos0 = [[0*s+0,0*s+0],[0*s+0,0*s+4],[2*s+0,0*s+6],[2*s-2,2*s+6],[2*s+0,4*s+6],[4*s+0,4*s+4],[6*s+0,4*s+6],[6*s+2,2*s+6],[6*s+6,2*s+6],[6*s+6,2*s+2],[4*s+6,2*s+0],[2*s+6,2*s-2],[0*s+6,2*s+0],[0*s+4,0*s+0],[0*s+0,0*s+0]];
const pos = [[[0,0],[0,4],[2*s,6],[2*s-2,2*s+6],[2*s,4*s+6],[4*s,4*s+4],[6*s,4*s+6],[6*s+2,2*s+6],[6*s+6,2*s+6],[6*s+6,2*s+2],[4*s+6,2*s],[2*s+6,2*s-2],[6,2*s],[4,0],[0,0]],
[[0,0],[-2,2*s],[0,4*s],[-2*s,4*s+2],[-2*s,4*s+6],[-2*s+4,4*s+6],[-2*s+6,6*s+6],[6,6*s+4],[2*s+6,6*s+6],[2*s+8,4*s+6],[2*s+6,2*s+6],[2*s+4,6],[2*s,6],[2*s,2],[0,0]],
[[0,0],[-2*s,2],[-2*s,6],[-2*s-4,6],[-2*s-6,2*s+6],[-6,2*s+8],[-6,2*s+12],[-2,2*s+12],[0,4*s+12],[2*s,4*s+10],[2*s,4*s+6],[2*s,4*s+2],[0,4*s],[2,2*s],[0,0]],
[[0,0],[-4,0],[-6,2*s],[-2*s-6,2*s-2],[-4*s-6,2*s],[-4*s-4,4*s],[-4*s-6,6*s],[-2*s-6,6*s+2],[-2*s-6,6*s+6],[-2*s-2,6*s+6],[-2*s,4*s+6],[-2*s+2,2*s+6],[-2*s,6],[0,4],[0,0]],
[[0,0],[-2*s,-2],[-4*s,0],[-4*s-2,-2*s],[-4*s-6,-2*s],[-4*s-6,-2*s+4],[-6*s-6,-2*s+6],[-6*s-4,6],[-6*s-6,2*s+6],[-4*s-6,2*s+8],[-2*s-6,2*s+6],[-6,2*s+4],[-6,2*s],[-2,2*s],[0,0]],
[[0,0],[-2,-2*s],[-6,-2*s],[-6,-2*s-4],[-2*s-6,-2*s-6],[-2*s-8,-6],[-2*s-12,-6],[-2*s-12,-2],[-4*s-12,0],[-4*s-10,2*s],[-4*s-6,2*s],[-4*s-2,2*s],[-4*s,0],[-2*s,2],[0,0]],
[[0,0],[0,-4],[-2*s,-6],[-2*s+2,-2*s-6],[-2*s,-4*s-6],[-4*s,-4*s-4],[-6*s,-4*s-6],[-6*s-2,-2*s-6],[-6*s-6,-2*s-6],[-6*s-6,-2*s-2],[-4*s-6,-2*s],[-2*s-6,-2*s+2],[-6,-2*s],[-4,0],[0,0]],
[[0,0],[2,-2*s],[0,-4*s],[2*s,-4*s-2],[2*s,-4*s-6],[2*s-4,-4*s-6],[2*s-6,-6*s-6],[-6,-6*s-4],[-2*s-6,-6*s-6],[-2*s-8,-4*s-6],[-2*s-6,-2*s-6],[-2*s-4,-6],[-2*s,-6],[-2*s,-2],[0,0]],
[[0,0],[2*s,-2],[2*s,-6],[2*s+4,-6],[2*s+6,-2*s-6],[6,-2*s-8],[6,-2*s-12],[2,-2*s-12],[0,-4*s-12],[-2*s,-4*s-10],[-2*s,-4*s-6],[-2*s,-4*s-2],[0,-4*s],[-2,-2*s],[0,0]],
[[0,0],[4,0],[6,-2*s],[2*s+6,-2*s+2],[4*s+6,-2*s],[4*s+4,-4*s],[4*s+6,-6*s],[2*s+6,-6*s-2],[2*s+6,-6*s-6],[2*s+2,-6*s-6],[2*s,-4*s-6],[2*s-2,-2*s-6],[2*s,-6],[0,-4],[0,0]],
[[0,0],[2*s,2],[4*s,0],[4*s+2,2*s],[4*s+6,2*s],[4*s+6,2*s-4],[6*s+6,2*s-6],[6*s+4,-6],[6*s+6,-2*s-6],[4*s+6,-2*s-8],[2*s+6,-2*s-6],[6,-2*s-4],[6,-2*s],[2,-2*s],[0,0]],
[[0,0],[2,2*s],[6,2*s],[6,2*s+4],[2*s+6,2*s+6],[2*s+8,6],[2*s+12,6],[2*s+12,2],[4*s+12,0],[4*s+10,-2*s],[4*s+6,-2*s],[4*s+2,-2*s],[4*s,0],[2*s,-2],[0,0]]];



//ctx.save();
ctx.translate(xmid,ymid);
const xscale=4;
ctx.scale(xscale,xscale);
//let MathPIby6 = Math.PI/6;
//ctx.rotate(degreesBy30*MathPIby6);

var ang=0;

//262240ms / 2065100
//maximum tiles inserted: 83, maximum edge count: 562
var tiles =
[[[0,0],[0,4],[3.4641,6],[1.4641,9.4641],[3.4641,12.9282],[6.9282,10.9282],[10.3923,12.9282],[12.3923,9.4641],[16.3923,9.4641],[16.3923,5.4641],[12.9282,3.4641],[9.4641,1.4641],[6,3.4641],[4,0],[0,0]],
[[3.4641,6],[0,4],[-3.4641,6],[-5.4641,2.5359],[-9.4641,2.5359],[-9.4641,6.5359],[-12.9282,8.5359],[-10.9282,12],[-12.9282,15.4641],[-9.4641,17.4641],[-6,15.4641],[-2.5359,13.4641],[-2.5359,9.4641],[1.4641,9.4641],[3.4641,6]],
[[6,3.4641],[9.4641,1.4641],[9.4641,-2.5359],[13.4641,-2.5359],[15.4641,-6],[12,-8],[12,-12],[8,-12],[6,-15.4641],[2.5359,-13.4641],[2.5359,-9.4641],[2.5359,-5.4641],[6,-3.4641],[4,0],[6,3.4641]],
[[-3.4641,6],[0,4],[4.44089e-16,0],[4,8.88178e-16],[6,-3.4641],[2.5359,-5.4641],[2.5359,-9.4641],[-1.4641,-9.4641],[-3.4641,-12.9282],[-6.9282,-10.9282],[-6.9282,-6.9282],[-6.9282,-2.9282],[-3.4641,-0.928203],[-5.4641,2.5359],[-3.4641,6]],
[[-2.5359,9.4641],[-2.5359,13.4641],[0.928203,15.4641],[-1.0718,18.9282],[0.928203,22.3923],[4.3923,20.3923],[7.85641,22.3923],[9.85641,18.9282],[13.8564,18.9282],[13.8564,14.9282],[10.3923,12.9282],[6.9282,10.9282],[3.4641,12.9282],[1.4641,9.4641],[-2.5359,9.4641]],
[[25.8564,6.9282],[25.8564,2.9282],[22.3923,0.928203],[24.3923,-2.5359],[22.3923,-6],[18.9282,-4],[15.4641,-6],[13.4641,-2.5359],[9.4641,-2.5359],[9.4641,1.4641],[12.9282,3.4641],[16.3923,5.4641],[19.8564,3.4641],[21.8564,6.9282],[25.8564,6.9282]],
[[-10.3923,-12.9282],[-6.9282,-10.9282],[-3.4641,-12.9282],[-1.4641,-9.4641],[2.5359,-9.4641],[2.5359,-13.4641],[6,-15.4641],[4,-18.9282],[6,-22.3923],[2.5359,-24.3923],[-0.928203,-22.3923],[-4.3923,-20.3923],[-4.3923,-16.3923],[-8.3923,-16.3923],[-10.3923,-12.9282]],
[[-3.4641,-0.928203],[-6.9282,-2.9282],[-10.3923,-0.928203],[-12.3923,-4.3923],[-16.3923,-4.3923],[-16.3923,-0.392305],[-19.8564,1.6077],[-17.8564,5.0718],[-19.8564,8.5359],[-16.3923,10.5359],[-12.9282,8.5359],[-9.4641,6.5359],[-9.4641,2.5359],[-5.4641,2.5359],[-3.4641,-0.928203]],
[[19.8564,3.4641],[16.3923,5.4641],[16.3923,9.4641],[12.3923,9.4641],[10.3923,12.9282],[13.8564,14.9282],[13.8564,18.9282],[17.8564,18.9282],[19.8564,22.3923],[23.3205,20.3923],[23.3205,16.3923],[23.3205,12.3923],[19.8564,10.3923],[21.8564,6.9282],[19.8564,3.4641]],
[[-15.4641,24.9282],[-12,26.9282],[-8.5359,24.9282],[-6.5359,28.3923],[-2.5359,28.3923],[-2.5359,24.3923],[0.928203,22.3923],[-1.0718,18.9282],[0.928203,15.4641],[-2.5359,13.4641],[-6,15.4641],[-9.4641,17.4641],[-9.4641,21.4641],[-13.4641,21.4641],[-15.4641,24.9282]],
[[22.3923,0.928203],[25.8564,2.9282],[29.3205,0.928203],[31.3205,4.3923],[35.3205,4.3923],[35.3205,0.392305],[38.7846,-1.6077],[36.7846,-5.0718],[38.7846,-8.5359],[35.3205,-10.5359],[31.8564,-8.5359],[28.3923,-6.5359],[28.3923,-2.5359],[24.3923,-2.5359],[22.3923,0.928203]],
[[-4.3923,-16.3923],[-4.3923,-20.3923],[-7.85641,-22.3923],[-5.85641,-25.8564],[-7.85641,-29.3205],[-11.3205,-27.3205],[-14.7846,-29.3205],[-16.7846,-25.8564],[-20.7846,-25.8564],[-20.7846,-21.8564],[-17.3205,-19.8564],[-13.8564,-17.8564],[-10.3923,-19.8564],[-8.3923,-16.3923],[-4.3923,-16.3923]],
[[-9.4641,21.4641],[-9.4641,17.4641],[-12.9282,15.4641],[-10.9282,12],[-12.9282,8.5359],[-16.3923,10.5359],[-19.8564,8.5359],[-21.8564,12],[-25.8564,12],[-25.8564,16],[-22.3923,18],[-18.9282,20],[-15.4641,18],[-13.4641,21.4641],[-9.4641,21.4641]],
[[-10.3923,-19.8564],[-13.8564,-17.8564],[-13.8564,-13.8564],[-17.8564,-13.8564],[-19.8564,-10.3923],[-16.3923,-8.3923],[-16.3923,-4.3923],[-12.3923,-4.3923],[-10.3923,-0.928203],[-6.9282,-2.9282],[-6.9282,-6.9282],[-6.9282,-10.9282],[-10.3923,-12.9282],[-8.3923,-16.3923],[-10.3923,-19.8564]],
[[29.3205,0.928203],[25.8564,2.9282],[25.8564,6.9282],[21.8564,6.9282],[19.8564,10.3923],[23.3205,12.3923],[23.3205,16.3923],[27.3205,16.3923],[29.3205,19.8564],[32.7846,17.8564],[32.7846,13.8564],[32.7846,9.85641],[29.3205,7.85641],[31.3205,4.3923],[29.3205,0.928203]],
[[-8.5359,24.9282],[-12,26.9282],[-12,30.9282],[-16,30.9282],[-18,34.3923],[-14.5359,36.3923],[-14.5359,40.3923],[-10.5359,40.3923],[-8.5359,43.8564],[-5.0718,41.8564],[-5.0718,37.8564],[-5.0718,33.8564],[-8.5359,31.8564],[-6.5359,28.3923],[-8.5359,24.9282]],
[[15.4641,-6],[18.9282,-4],[22.3923,-6],[24.3923,-2.5359],[28.3923,-2.5359],[28.3923,-6.5359],[31.8564,-8.5359],[29.8564,-12],[31.8564,-15.4641],[28.3923,-17.4641],[24.9282,-15.4641],[21.4641,-13.4641],[21.4641,-9.4641],[17.4641,-9.4641],[15.4641,-6]],
[[8.5359,-31.8564],[5.0718,-33.8564],[1.6077,-31.8564],[-0.392305,-35.3205],[-4.3923,-35.3205],[-4.3923,-31.3205],[-7.85641,-29.3205],[-5.85641,-25.8564],[-7.85641,-22.3923],[-4.3923,-20.3923],[-0.928203,-22.3923],[2.5359,-24.3923],[2.5359,-28.3923],[6.5359,-28.3923],[8.5359,-31.8564]],
[[-12,30.9282],[-12,26.9282],[-15.4641,24.9282],[-13.4641,21.4641],[-15.4641,18],[-18.9282,20],[-22.3923,18],[-24.3923,21.4641],[-28.3923,21.4641],[-28.3923,25.4641],[-24.9282,27.4641],[-21.4641,29.4641],[-18,27.4641],[-16,30.9282],[-12,30.9282]],
[[-30.2487,-23.3205],[-30.2487,-19.3205],[-26.7846,-17.3205],[-28.7846,-13.8564],[-26.7846,-10.3923],[-23.3205,-12.3923],[-19.8564,-10.3923],[-17.8564,-13.8564],[-13.8564,-13.8564],[-13.8564,-17.8564],[-17.3205,-19.8564],[-20.7846,-21.8564],[-24.2487,-19.8564],[-26.2487,-23.3205],[-30.2487,-23.3205]],
[[36.2487,19.8564],[32.7846,17.8564],[29.3205,19.8564],[27.3205,16.3923],[23.3205,16.3923],[23.3205,20.3923],[19.8564,22.3923],[21.8564,25.8564],[19.8564,29.3205],[23.3205,31.3205],[26.7846,29.3205],[30.2487,27.3205],[30.2487,23.3205],[34.2487,23.3205],[36.2487,19.8564]],
[[29.3205,7.85641],[32.7846,9.85641],[36.2487,7.85641],[38.2487,11.3205],[42.2487,11.3205],[42.2487,7.32051],[45.7128,5.32051],[43.7128,1.85641],[45.7128,-1.6077],[42.2487,-3.6077],[38.7846,-1.6077],[35.3205,0.392305],[35.3205,4.3923],[31.3205,4.3923],[29.3205,7.85641]],
[[-8.5359,31.8564],[-5.0718,33.8564],[-1.6077,31.8564],[0.392305,35.3205],[4.3923,35.3205],[4.3923,31.3205],[7.85641,29.3205],[5.85641,25.8564],[7.85641,22.3923],[4.3923,20.3923],[0.928203,22.3923],[-2.5359,24.3923],[-2.5359,28.3923],[-6.5359,28.3923],[-8.5359,31.8564]],
[[31.8564,-8.5359],[35.3205,-10.5359],[35.3205,-14.5359],[39.3205,-14.5359],[41.3205,-18],[37.8564,-20],[37.8564,-24],[33.8564,-24],[31.8564,-27.4641],[28.3923,-25.4641],[28.3923,-21.4641],[28.3923,-17.4641],[31.8564,-15.4641],[29.8564,-12],[31.8564,-8.5359]],
[[6,-15.4641],[8,-12],[12,-12],[12,-8],[15.4641,-6],[17.4641,-9.4641],[21.4641,-9.4641],[21.4641,-13.4641],[24.9282,-15.4641],[22.9282,-18.9282],[18.9282,-18.9282],[14.9282,-18.9282],[12.9282,-15.4641],[9.4641,-17.4641],[6,-15.4641]],
[[1.6077,-31.8564],[5.0718,-33.8564],[5.0718,-37.8564],[9.0718,-37.8564],[11.0718,-41.3205],[7.6077,-43.3205],[7.6077,-47.3205],[3.6077,-47.3205],[1.6077,-50.7846],[-1.85641,-48.7846],[-1.85641,-44.7846],[-1.85641,-40.7846],[1.6077,-38.7846],[-0.392305,-35.3205],[1.6077,-31.8564]],
[[2.5359,-28.3923],[2.5359,-24.3923],[6,-22.3923],[4,-18.9282],[6,-15.4641],[9.4641,-17.4641],[12.9282,-15.4641],[14.9282,-18.9282],[18.9282,-18.9282],[18.9282,-22.9282],[15.4641,-24.9282],[12,-26.9282],[8.5359,-24.9282],[6.5359,-28.3923],[2.5359,-28.3923]],
[[-31.8564,27.4641],[-28.3923,25.4641],[-28.3923,21.4641],[-24.3923,21.4641],[-22.3923,18],[-25.8564,16],[-25.8564,12],[-29.8564,12],[-31.8564,8.5359],[-35.3205,10.5359],[-35.3205,14.5359],[-35.3205,18.5359],[-31.8564,20.5359],[-33.8564,24],[-31.8564,27.4641]],
[[-18,27.4641],[-21.4641,29.4641],[-21.4641,33.4641],[-25.4641,33.4641],[-27.4641,36.9282],[-24,38.9282],[-24,42.9282],[-20,42.9282],[-18,46.3923],[-14.5359,44.3923],[-14.5359,40.3923],[-14.5359,36.3923],[-18,34.3923],[-16,30.9282],[-18,27.4641]],
[[-26.7846,-17.3205],[-30.2487,-19.3205],[-33.7128,-17.3205],[-35.7128,-20.7846],[-39.7128,-20.7846],[-39.7128,-16.7846],[-43.1769,-14.7846],[-41.1769,-11.3205],[-43.1769,-7.85641],[-39.7128,-5.85641],[-36.2487,-7.85641],[-32.7846,-9.85641],[-32.7846,-13.8564],[-28.7846,-13.8564],[-26.7846,-17.3205]],
[[-24.2487,-19.8564],[-20.7846,-21.8564],[-20.7846,-25.8564],[-16.7846,-25.8564],[-14.7846,-29.3205],[-18.2487,-31.3205],[-18.2487,-35.3205],[-22.2487,-35.3205],[-24.2487,-38.7846],[-27.7128,-36.7846],[-27.7128,-32.7846],[-27.7128,-28.7846],[-24.2487,-26.7846],[-26.2487,-23.3205],[-24.2487,-19.8564]],
[[30.2487,23.3205],[30.2487,27.3205],[33.7128,29.3205],[31.7128,32.7846],[33.7128,36.2487],[37.1769,34.2487],[40.641,36.2487],[42.641,32.7846],[46.641,32.7846],[46.641,28.7846],[43.1769,26.7846],[39.7128,24.7846],[36.2487,26.7846],[34.2487,23.3205],[30.2487,23.3205]],
[[35.3205,-14.5359],[35.3205,-10.5359],[38.7846,-8.5359],[36.7846,-5.0718],[38.7846,-1.6077],[42.2487,-3.6077],[45.7128,-1.6077],[47.7128,-5.0718],[51.7128,-5.0718],[51.7128,-9.0718],[48.2487,-11.0718],[44.7846,-13.0718],[41.3205,-11.0718],[39.3205,-14.5359],[35.3205,-14.5359]],
[[36.2487,26.7846],[39.7128,24.7846],[39.7128,20.7846],[43.7128,20.7846],[45.7128,17.3205],[42.2487,15.3205],[42.2487,11.3205],[38.2487,11.3205],[36.2487,7.85641],[32.7846,9.85641],[32.7846,13.8564],[32.7846,17.8564],[36.2487,19.8564],[34.2487,23.3205],[36.2487,26.7846]],
[[-1.6077,50.7846],[1.85641,48.7846],[1.85641,44.7846],[5.85641,44.7846],[7.85641,41.3205],[4.3923,39.3205],[4.3923,35.3205],[0.392305,35.3205],[-1.6077,31.8564],[-5.0718,33.8564],[-5.0718,37.8564],[-5.0718,41.8564],[-1.6077,43.8564],[-3.6077,47.3205],[-1.6077,50.7846]],
[[24.9282,-34.3923],[21.4641,-32.3923],[21.4641,-28.3923],[17.4641,-28.3923],[15.4641,-24.9282],[18.9282,-22.9282],[18.9282,-18.9282],[22.9282,-18.9282],[24.9282,-15.4641],[28.3923,-17.4641],[28.3923,-21.4641],[28.3923,-25.4641],[24.9282,-27.4641],[26.9282,-30.9282],[24.9282,-34.3923]],
[[5.0718,-37.8564],[5.0718,-33.8564],[8.5359,-31.8564],[6.5359,-28.3923],[8.5359,-24.9282],[12,-26.9282],[15.4641,-24.9282],[17.4641,-28.3923],[21.4641,-28.3923],[21.4641,-32.3923],[18,-34.3923],[14.5359,-36.3923],[11.0718,-34.3923],[9.0718,-37.8564],[5.0718,-37.8564]],
[[1.6077,-38.7846],[-1.85641,-40.7846],[-5.32051,-38.7846],[-7.32051,-42.2487],[-11.3205,-42.2487],[-11.3205,-38.2487],[-14.7846,-36.2487],[-12.7846,-32.7846],[-14.7846,-29.3205],[-11.3205,-27.3205],[-7.85641,-29.3205],[-4.3923,-31.3205],[-4.3923,-35.3205],[-0.392305,-35.3205],[1.6077,-38.7846]],
[[-31.8564,20.5359],[-35.3205,18.5359],[-38.7846,20.5359],[-40.7846,17.0718],[-44.7846,17.0718],[-44.7846,21.0718],[-48.2487,23.0718],[-46.2487,26.5359],[-48.2487,30],[-44.7846,32],[-41.3205,30],[-37.8564,28],[-37.8564,24],[-33.8564,24],[-31.8564,20.5359]],
[[-1.6077,43.8564],[-5.0718,41.8564],[-8.5359,43.8564],[-10.5359,40.3923],[-14.5359,40.3923],[-14.5359,44.3923],[-18,46.3923],[-16,49.8564],[-18,53.3205],[-14.5359,55.3205],[-11.0718,53.3205],[-7.6077,51.3205],[-7.6077,47.3205],[-3.6077,47.3205],[-1.6077,43.8564]],
[[-37.8564,24],[-37.8564,28],[-34.3923,30],[-36.3923,33.4641],[-34.3923,36.9282],[-30.9282,34.9282],[-27.4641,36.9282],[-25.4641,33.4641],[-21.4641,33.4641],[-21.4641,29.4641],[-24.9282,27.4641],[-28.3923,25.4641],[-31.8564,27.4641],[-33.8564,24],[-37.8564,24]],
[[-33.7128,-17.3205],[-30.2487,-19.3205],[-30.2487,-23.3205],[-26.2487,-23.3205],[-24.2487,-26.7846],[-27.7128,-28.7846],[-27.7128,-32.7846],[-31.7128,-32.7846],[-33.7128,-36.2487],[-37.1769,-34.2487],[-37.1769,-30.2487],[-37.1769,-26.2487],[-33.7128,-24.2487],[-35.7128,-20.7846],[-33.7128,-17.3205]],
[[-32.7846,-13.8564],[-32.7846,-9.85641],[-29.3205,-7.85641],[-31.3205,-4.3923],[-29.3205,-0.928203],[-25.8564,-2.9282],[-22.3923,-0.928203],[-20.3923,-4.3923],[-16.3923,-4.3923],[-16.3923,-8.3923],[-19.8564,-10.3923],[-23.3205,-12.3923],[-26.7846,-10.3923],[-28.7846,-13.8564],[-32.7846,-13.8564]],
[[17.3205,38.7846],[20.7846,40.7846],[24.2487,38.7846],[26.2487,42.2487],[30.2487,42.2487],[30.2487,38.2487],[33.7128,36.2487],[31.7128,32.7846],[33.7128,29.3205],[30.2487,27.3205],[26.7846,29.3205],[23.3205,31.3205],[23.3205,35.3205],[19.3205,35.3205],[17.3205,38.7846]],
[[41.3205,-11.0718],[44.7846,-13.0718],[44.7846,-17.0718],[48.7846,-17.0718],[50.7846,-20.5359],[47.3205,-22.5359],[47.3205,-26.5359],[43.3205,-26.5359],[41.3205,-30],[37.8564,-28],[37.8564,-24],[37.8564,-20],[41.3205,-18],[39.3205,-14.5359],[41.3205,-11.0718]],
[[56.1051,30.2487],[56.1051,26.2487],[52.641,24.2487],[54.641,20.7846],[52.641,17.3205],[49.1769,19.3205],[45.7128,17.3205],[43.7128,20.7846],[39.7128,20.7846],[39.7128,24.7846],[43.1769,26.7846],[46.641,28.7846],[50.1051,26.7846],[52.1051,30.2487],[56.1051,30.2487]],
[[1.85641,44.7846],[1.85641,48.7846],[5.32051,50.7846],[3.32051,54.2487],[5.32051,57.7128],[8.78461,55.7128],[12.2487,57.7128],[14.2487,54.2487],[18.2487,54.2487],[18.2487,50.2487],[14.7846,48.2487],[11.3205,46.2487],[7.85641,48.2487],[5.85641,44.7846],[1.85641,44.7846]],
[[24.9282,-27.4641],[28.3923,-25.4641],[31.8564,-27.4641],[33.8564,-24],[37.8564,-24],[37.8564,-28],[41.3205,-30],[39.3205,-33.4641],[41.3205,-36.9282],[37.8564,-38.9282],[34.3923,-36.9282],[30.9282,-34.9282],[30.9282,-30.9282],[26.9282,-30.9282],[24.9282,-27.4641]]];//102/102 level-7 open corner will try 0 (10->ang)
var allpoints = [];
var deltax=-0.5*xmid/xscale; var deltay=-0.5*ymid/xscale;

var allpoints_length = allpoints.length;

for (var itile=0; itile<tiles.length; itile++) {
    var lines = new Path2D; for (const point of tiles[itile]) { lines.lineTo(point[0] + deltax,point[1] + deltay) } ctx.strokeStyle = "red"; ctx.stroke(lines);    
}

for (var itile=0; itile<tiles.length; itile++) {
        allpoints_length = allpoints.length;
        for (var ipt=1; ipt<tiles[itile].length; ipt++) { const posangpt0 = tiles[itile][ipt][0] + deltax; const posangpt1 = tiles[itile][ipt][1] + deltay;
            var break_count = 0; for (var i=0; i<allpoints_length; i++)
                {if ((posangpt0-allpoints[i][0])*(posangpt0-allpoints[i][0]) + (posangpt1-allpoints[i][1])*(posangpt1-allpoints[i][1]) < TINY) {break_count=1; break;}}
            if (break_count<1) allpoints.push([posangpt0, posangpt1]);}
    
}



//for (var ipt=0; ipt<pos[ang].length; ipt++) { const posangpt0 = pos[ang][ipt][0] + deltax; const posangpt1 = pos[ang][ipt][1] + deltay;
//    var break_count = 0; for (var i=0; i<allpoints_length; i++)
//        {if ((posangpt0-allpoints[i][0])*(posangpt0-allpoints[i][0]) + (posangpt1-allpoints[i][1])*(posangpt1-allpoints[i][1]) < TINY) {break_count=1; break;}}
//    if (break_count<1) allpoints.push([posangpt0, posangpt1]);}

//var allLines = new Path2D; for (const point of allpoints) { allLines.lineTo(point[0],point[1]) } ctx.strokeStyle = "red"; ctx.stroke(allLines);
////const paths = new Path2D; paths.addPath(myLines); paths.addPath(myLines2); //can also have many paths like this, and stroke still understands the context


var myLines = new Path2D;
for (const point of pos[ang]) { myLines.lineTo(point[0],point[1]) }  //for (const point of data) { myLines.lineTo(...point) }  // ... flattens array, so equivalent to (const point of data) { myLines.lineTo(point[0],point[1]) }
ctx.strokeStyle = "black";
ctx.stroke(myLines);

document.onkeydown = function(e) {
    //if (e.key == ",") {ang++; if (ang==12) ang=0;
    if (e.key == "ArrowLeft") {ang++; if (ang==12) ang=0;
        ctx.strokeStyle = "white"; ctx.stroke(myLines);
        myLines = new Path2D;
        for (const point of pos[ang]) { myLines.lineTo(point[0],point[1]) }  //for (const point of data) { myLines.lineTo(...point) }  // ... flattens array, so equivalent to (const point of data) { myLines.lineTo(point[0],point[1]) }
        ctx.strokeStyle = "black"; ctx.stroke(myLines);}
    //if (e.key == ".") {ang--; if (ang==-1) ang=11;
    if (e.key == "ArrowRight") {ang--; if (ang==-1) ang=11;
        ctx.strokeStyle = "white"; ctx.stroke(myLines);
        myLines = new Path2D;
        for (const point of pos[ang]) { myLines.lineTo(point[0],point[1]) }  //for (const point of data) { myLines.lineTo(...point) }  // ... flattens array, so equivalent to (const point of data) { myLines.lineTo(point[0],point[1]) }
        ctx.strokeStyle = "black"; ctx.stroke(myLines);}
    if (e.key == "Backspace") {
        ctx.clearRect(-xmid,-ymid, 2*xmid, 2*ymid); //fastest way to clear a rectangular area?
        allpoints.length = allpoints_length;
        var allLines = new Path2D; for (const point of allpoints) { allLines.lineTo(point[0],point[1]) } ctx.strokeStyle = "red"; ctx.stroke(allLines);
        ctx.strokeStyle = "black"; ctx.stroke(myLines);   
    }
}

var refpoint = [0,0];
c.onmousedown = function(e) { //get nearest point from allpoints and myLines
    lastX = e.pageX - this.offsetLeft - xmid;
    lastY = e.pageY - this.offsetTop  - ymid;
    
    var distance_min=200*xscale*xscale; var point_min = refpoint;
    for (const point of pos[ang]) {
        const distance = (lastX-xscale*point[0])*(lastX-xscale*point[0]) + (lastY-xscale*point[1])*(lastY-xscale*point[1]);
        if (distance_min > distance) {distance_min = distance; point_min = point}}

    var alldista_min=100*xscale*xscale; var allpt_min=[50,50];
    for (const point of allpoints) {
        const distance = (lastX-xscale*point[0])*(lastX-xscale*point[0]) + (lastY-xscale*point[1])*(lastY-xscale*point[1]);
        if (alldista_min > distance) {alldista_min = distance; allpt_min = point}}
    
    if ((distance_min < alldista_min)||(10*xscale*xscale < alldista_min)) refpoint = point_min;
    else {
        ctx.translate( allpt_min[0]-refpoint[0], allpt_min[1]-refpoint[1]);
        ctx.strokeStyle = "black"; ctx.stroke(myLines);
        ctx.translate(-allpt_min[0]+refpoint[0],-allpt_min[1]+refpoint[1]);
        
        deltax=allpt_min[0]-refpoint[0]; deltay=allpt_min[1]-refpoint[1];
        allpoints_length = allpoints.length;
        for (var ipt=1; ipt<pos[ang].length; ipt++) { const posangpt0 = pos[ang][ipt][0] + deltax; const posangpt1 = pos[ang][ipt][1] + deltay;
            var break_count = 0; for (var i=0; i<allpoints_length; i++)
                {if ((posangpt0-allpoints[i][0])*(posangpt0-allpoints[i][0]) + (posangpt1-allpoints[i][1])*(posangpt1-allpoints[i][1]) < TINY) {break_count=1; break;}}
            if (break_count<1) allpoints.push([posangpt0, posangpt1]);}
    }
}
    
    

/*

ctx.strokeStyle = "black";
ctx.beginPath();

//292800ms / 2065100
//maximum tiles inserted: 83, maximum edge count: 562

ctx.moveTo(0*scale,0*scale);
ctx.lineTo(0*scale,4*scale);
ctx.moveTo(0*scale,4*scale);
ctx.lineTo(3.4641*scale,6*scale);
ctx.moveTo(3.4641*scale,6*scale);
ctx.lineTo(1.4641*scale,9.4641*scale);

//ctx.closePath();
ctx.stroke();

//ctx.restore();

*/





</script>
</body>
</html>
